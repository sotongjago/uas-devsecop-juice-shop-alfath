name: DevSecOps Pipeline

on: [push]

jobs:
  security:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3

    - name: SAST
      run: npm audit --audit-level=high || true

    - name: Build Image
      run: docker build -t juice-shop .

    - name: Container Scan
      run: trivy image juice-shop

    - name: DAST
      run: docker run -t owasp/zap2docker-stable zap-baseline.py \
           -t http://localhost:3000
